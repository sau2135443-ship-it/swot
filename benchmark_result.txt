Old implementation (parts): 1313ms
New implementation (string): 693ms